{% extends "base.html" %}
{% block title %}WebScraper - Analyzer{% endblock %}
{% block head %}
<style>
  .webscraper-page { max-width: 1400px; margin: 0 auto; padding: 2rem; }
  .page-header { margin-bottom: 2rem; }
  .page-title { font-size: 2rem; font-weight: 700; color: #1f2937; margin: 0 0 0.5rem 0; }
  .subtitle { color: #6b7280; font-size: 1rem; margin: 0; }
  .analyzer-container { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
  @media (max-width: 1024px) { .analyzer-container { grid-template-columns: 1fr; } }
  .input-panel, .results-panel { background: #fff; border: 1px solid #e5e7eb; border-radius: 12px; padding: 1.5rem; }
  .results-panel { min-height: 500px; }
  .form-group { margin-bottom: 1.5rem; }
  .form-label { display: block; font-weight: 600; color: #1f2937; margin-bottom: 0.5rem; }
  .form-input { width: 100%; padding: 0.75rem; border: 1px solid #e5e7eb; border-radius: 8px; font-size: 0.875rem; }
  .form-textarea { min-height: 120px; resize: vertical; }
  .btn-analyze { width: 100%; padding: 0.875rem; background: #00b5ad; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; }
  .btn-analyze:hover { background: #00a89e; }
  .btn-analyze:disabled { opacity: 0.6; cursor: not-allowed; }
  .results-title { font-weight: 600; font-size: 1.125rem; margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 1px solid #e5e7eb; }
  .results-placeholder { text-align: center; padding: 3rem; color: #9ca3af; }
  .result-card { background: #f9fafb; border: 1px solid #e5e7eb; border-radius: 8px; padding: 1rem; margin-bottom: 0.75rem; }
  .result-text { white-space: pre-wrap; line-height: 1.6; }
  .success-message { background: #dcfce7; border: 1px solid #bbf7d0; border-radius: 8px; padding: 1rem; color: #166534; margin-bottom: 1rem; }
  .error-message { background: #fee2e2; border: 1px solid #fecaca; border-radius: 8px; padding: 1rem; color: #991b1b; margin-bottom: 1rem; }
  .example-prompts { background: #f3f4f6; border-radius: 8px; padding: 1rem; margin-top: 1rem; }
  .example-prompts-title { font-size: 0.75rem; font-weight: 600; color: #6b7280; text-transform: uppercase; margin: 0 0 0.75rem 0; }
  .example-prompt { display: block; padding: 0.5rem; background: #fff; border: 1px solid #e5e7eb; border-radius: 6px; margin-bottom: 0.5rem; font-size: 0.8rem; cursor: pointer; }
  .example-prompt:hover { border-color: #00b5ad; }
  </style>
{% endblock %}
{% block content %}
<div class="container webscraper-page">
      <header class="page-header">
                <h1 class="page-title">WebScraper</h1>h1>
                <p class="subtitle">Analyze websites using natural language prompts</p>p>
      </header>header>
      <div class="analyzer-container">
                <div class="input-panel">
                              <form id="scraper-form">
                                                <div class="form-group">
                                                                      <label class="form-label" for="website-url">Website URL</label>label>
                                                                      <input type="url" id="website-url" class="form-input" placeholder="https://example.com" required>
                                                </div>div>
                                                <div class="form-group">
                                                                      <label class="form-label" for="analysis-prompt">What would you like to analyze?</label>label>
                                                                      <textarea id="analysis-prompt" class="form-input form-textarea" placeholder="E.g., Extract pricing info, Find contact details, Identify i18n features..." required></textarea>
                                                </div>div>
                                                <button type="submit" class="btn-analyze" id="analyze-btn">Analyze Website</button>button>
                                                <div class="example-prompts">
                                                                      <div class="example-prompts-title">Example Prompts</div>div>
                                                                      <div class="example-prompt" data-prompt="Extract all contact information including emails, phone numbers, and addresses">Extract all contact information</div>div>
                                                                      <div class="example-prompt" data-prompt="Identify all internationalization and localization features (language switchers, hreflang tags)">Identify i18n/l10n features</div>div>
                                                                      <div class="example-prompt" data-prompt="Find all pricing information and subscription tiers">Extract pricing information</div>div>
                                                </div>div>
                              </form>form>
                </div>div>
                <div class="results-panel">
                              <h2 class="results-title">Analysis Results</h2>h2>
                              <div id="results-placeholder" class="results-placeholder">Enter a website URL and prompt to start analyzing</div>div>
                              <div id="results-content" style="display: none;"></div>div>
                </div>div>
      </div>div>
</div>div>
{% endblock %}
{% block scripts %}
<script>
  document.querySelectorAll('.example-prompt').forEach(p => p.addEventListener('click', () => document.getElementById('analysis-prompt').value = p.dataset.prompt));
  document.getElementById('scraper-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const url = document.getElementById('website-url').value;
        const prompt = document.getElementById('analysis-prompt').value;
        const btn = document.getElementById('analyze-btn');
        const placeholder = document.getElementById('results-placeholder');
        const content = document.getElementById('results-content');
        btn.disabled = true; btn.textContent = 'Analyzing...';
        placeholder.style.display = 'none'; content.style.display = 'block';
        content.innerHTML = '<div style="text-align:center;color:#9ca3af;">Processing...</div>';
        try {
                  const response = await fetch('/api/webscraper/analyze', {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify({url, prompt})});
                  const data = await response.json();
                  if (!response.ok) throw new Error(data.error || 'Analysis failed');
                  content.innerHTML = '<div class="success-message">Analysis completed</div><div class="result-card"><div class="result-text">' + (data.analysis || JSON.stringify(data, null, 2)).replace(/</g, '&lt;') + '</div></div>';
        } catch (error) { content.innerHTML = '<div class="error-message">Error: ' + error.message + '</div>'; }
        finally { btn.disabled = false; btn.textContent = 'Analyze Website'; }
  });
</script>
{% endblock %}
</script>
</style>
